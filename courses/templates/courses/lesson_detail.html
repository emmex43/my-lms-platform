{% extends 'courses/base.html' %}

{% block content %}
<div class="container" style="max-width: 800px;">

    <a href="{% url 'course_detail' course.id %}"
        style="text-decoration: none; color: #7f8c8d; margin-bottom: 20px; display: inline-block;">
        &larr; Back to {{ course.title }}
    </a>

    <h2 style="margin-top: 0;">{{ lesson.title }}</h2>

    {% if lesson.video_url %}
    <div
        style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; background: #000; margin-bottom: 20px; border-radius: 10px;">
        <iframe src="https://www.youtube.com/embed/{{ lesson.get_video_id }}"
            style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;" frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
            allowfullscreen>
        </iframe>
    </div>
    {% endif %}

    <div class="lesson-content" style="font-size: 1.1rem; line-height: 1.6;">
        {{ lesson.content|linebreaks }}
    </div>

    <hr style="margin: 40px 0;">

    {% if lesson.quiz_question %}
    <div style="background: #f8f9fa; padding: 25px; border-radius: 10px; border: 1px solid #ddd; margin-top: 30px;">
        <h3 style="margin-top: 0; color: #2c3e50;">üìù Quick Quiz</h3>

        {% if quiz_result %}
        <div class="quiz-result {% if 'Correct' in quiz_result %}quiz-success{% else %}quiz-error{% endif %}">
            {{ quiz_result }}
        </div>
        {% endif %}
        <p style="font-size: 1.2rem; font-weight: bold; margin-bottom: 15px;">{{ lesson.quiz_question }}</p>

        <form method="post">
            {% csrf_token %}

            <div style="margin-bottom: 10px;">
                <label
                    style="cursor: pointer; display: block; padding: 10px; background: white; border: 1px solid #eee; border-radius: 5px;">
                    <input type="radio" name="answer" value="A" required style="margin-right: 10px;">
                    <strong style="color: #3498db;">A:</strong> {{ lesson.option_a }}
                </label>
            </div>

            <div style="margin-bottom: 10px;">
                <label
                    style="cursor: pointer; display: block; padding: 10px; background: white; border: 1px solid #eee; border-radius: 5px;">
                    <input type="radio" name="answer" value="B" style="margin-right: 10px;">
                    <strong style="color: #3498db;">B:</strong> {{ lesson.option_b }}
                </label>
            </div>

            <div style="margin-bottom: 10px;">
                <label
                    style="cursor: pointer; display: block; padding: 10px; background: white; border: 1px solid #eee; border-radius: 5px;">
                    <input type="radio" name="answer" value="C" style="margin-right: 10px;">
                    <strong style="color: #3498db;">C:</strong> {{ lesson.option_c }}
                </label>
            </div>

            <button type="submit" class="btn"
                style="background-color: #3498db; color: white; margin-top: 15px; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 1rem;">
                Check Answer
            </button>
        </form>
    </div>
    {% endif %}

</div>
{% endblock %}